<!--
  Attention!!! This file was generated by Chef client.
  Any manual changes will be overwritten during the next chef run.

  Wazuh - Manager
  More info at: https://documentation.wazuh.com
  Mailing list: https://groups.google.com/forum/#!forum/wazuh
-->

<ossec_config>
  <global>
    <jsonout_output>yes</jsonout_output>
    <alerts_log>yes</alerts_log>
    <logall>no</logall>
    <logall_json>no</logall_json>
    <email_notification><%= @email_notification ? 'yes' : 'no' %></email_notification>
    <smtp_server><%= @smtp_server %></smtp_server>
    <email_from><%= @email_from %></email_from>
    <email_to><%= @email_to %></email_to>
    <email_maxperhour>12</email_maxperhour>
  </global>

  <alerts>
    <log_alert_level><%= @log_alert_level %></log_alert_level>
    <email_alert_level><%= @email_alert_level %></email_alert_level>
  </alerts>

  <!-- Choose between plain or json format (or both) for internal logs -->
  <logging>
    <log_format><%= @log_format %></log_format>
  </logging>

<%= render 'remote.partial.erb', variables: @remote.to_h.merge('listen_on' => @listen_on) %>

    <!-- Policy monitoring -->
<%= render 'rootcheck.partial.erb', variables: @rootcheck.to_h %>

<%= render 'wodle-openscap.partial.erb', variables: @wodle_openscap.to_h %>

  <!-- File integrity monitoring -->
<%= render 'syscheck.partial.erb', variables: @syscheck.to_h %>

  <!-- Log analysis -->
<%= render 'localfile.partial.erb', variables: @localfile.to_h %>

  <ruleset>
    <!-- Default ruleset -->
    <decoder_dir>ruleset/decoders</decoder_dir>
    <rule_dir>ruleset/rules</rule_dir>
    <rule_exclude>0215-policy_rules.xml</rule_exclude>
    <list>etc/lists/audit-keys</list>

    <!-- User-defined ruleset -->
    <decoder_dir>etc/decoders</decoder_dir>
    <rule_dir>etc/rules</rule_dir>
  </ruleset>

<% if @auth['disabled'] == 'no' %>
  <!-- Configuration for ossec-authd
    To enable this service, run:
    ossec-control enable auth
  -->
<%= render 'auth.partial.erb', variables: @auth.to_h %>
<% end -%>

</ossec_config>